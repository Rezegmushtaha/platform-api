<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.README.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-Platform+API">Platform API</h1>

<p>Ruby HTTP client for the Heroku API.</p>

<blockquote>
<p>NOTE: v2.0.0 fixed a long-standing issue with duplicated link titles, which
may break things if you were relying on the now-renamed methods.</p>
</blockquote>

<h2 id="label-Installation">Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>platform-api</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>And then execute:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bundle'>bundle</span>
</code></pre>

<p>Or install it yourself as:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_platform'>platform</span><span class='op'>-</span><span class='id identifier rubyid_api'>api</span>
</code></pre>

<h2 id="label-API+documentation">API documentation</h2>

<p>Jump right to the <a
href="http://heroku.github.io/platform-api/_index.html">API
documentation</a> for the nitty gritty details.</p>

<h2 id="label-Usage+guide">Usage guide</h2>

<p>The best place to start using the Heroku API is the <a
href="https://devcenter.heroku.com/articles/platform-api-reference">Platform
API Reference</a>. It has detailed descriptions of the HTTP API, including
general information about authentication, caching, object identifiers, rate
limits, etc. It also includes detailed information about each supported
resource and the actions available for them.</p>

<p>The table of contents lists all the resources that are supported, such as
App, Add-on, Config Vars, Formation, etc. Each resource includes detailed
information about the support actions. For example, the <a
href="https://devcenter.heroku.com/articles/platform-api-reference#formation">Formation</a>
resource has <a
href="https://devcenter.heroku.com/articles/platform-api-reference#formation-info">Info</a>,
<a
href="https://devcenter.heroku.com/articles/platform-api-reference#formation-list">List</a>,
<a
href="https://devcenter.heroku.com/articles/platform-api-reference#formation-batch-update">Batch
update</a>, and <a
href="https://devcenter.heroku.com/articles/platform-api-reference#formation-update">Update</a>
actions.</p>

<p>Resources and their related actions are available as methods on the client.
When the URL for an action includes parameters they&#39;re passed as
arguments to the method. When the request expects a request payload
it&#39;s passed as a Hash in the final argument to the method.</p>

<p>For example, to get information about the <code>web</code> formation on the
<code>sushi</code> app you&#39;d invoke
<code>heroku.formation.info(&#39;sushi&#39;, &#39;web&#39;)</code> and it
would return a Ruby object that matches the one given in the <a
href="https://devcenter.heroku.com/articles/platform-api-reference#formation-info">response
example</a>.</p>

<p>The <a href="http://heroku.github.io/platform-api/_index.html">API
documentation</a> contains a description of all available resources and
methods.</p>

<h3 id="label-Handling+errors">Handling errors</h3>

<p>The client uses <a href="https://github.com/excon/excon">Excon</a> under
the hood and raises <code>Excon::Error</code> exceptions when errors occur.
You can catch specific <a
href="https://github.com/excon/excon/blob/master/lib/excon/error.rb">Excon
error types</a> if you want.</p>

<h3 id="label-A+real+world+example">A real world example</h3>

<p>Let&#39;s go through an example of creating an app and using the API to
work with it. The first thing you need is a client setup with an OAuth
token. You can create an OAuth token using the <code>heroku-oauth</code>
toolbelt plugin:</p>

<pre class="code ruby"><code class="ruby">$ heroku plugins:install heroku-cli-oauth
$ heroku authorizations:create -d &quot;Platform API example token&quot;
Created OAuth authorization.
  ID:          2f01aac0-e9d3-4773-af4e-3e510aa006ca
  Description: Platform API example token
  Scope:       global
  Token:       e7dd6ad7-3c6a-411e-a2be-c9fe52ac7ed2</code></pre>

<p>Use the <code>Token</code> value when instantiating a client:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>platform-api</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_heroku'>heroku</span> <span class='op'>=</span> <span class='const'>PlatformAPI</span><span class='period'>.</span><span class='id identifier rubyid_connect_oauth'>connect_oauth</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>e7dd6ad7-3c6a-411e-a2be-c9fe52ac7ed2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>The <a href="https://devcenter.heroku.com/articles/oauth">OAuth article</a>
has more information about OAuth tokens, including how to create tokens
with specific scopes.</p>

<p>Now let&#39;s create an app:</p>

<pre class="code ruby"><code class="ruby">heroku.app.create({})
=&gt; {&quot;id&quot;=&gt;22979756,
    &quot;name&quot;=&gt;&quot;floating-retreat-4255&quot;,
    &quot;dynos&quot;=&gt;0,
    &quot;workers&quot;=&gt;0,
    &quot;repo_size&quot;=&gt;nil,
    &quot;slug_size&quot;=&gt;nil,
    &quot;stack&quot;=&gt;&quot;cedar&quot;,
    &quot;requested_stack&quot;=&gt;nil,
    &quot;create_status&quot;=&gt;&quot;complete&quot;,
    &quot;repo_migrate_status&quot;=&gt;&quot;complete&quot;,
    &quot;owner_delinquent&quot;=&gt;false,
    &quot;owner_email&quot;=&gt;&quot;jkakar@heroku.com&quot;,
    &quot;owner_name&quot;=&gt;nil,
    &quot;domain_name&quot;=&gt;
     {&quot;id&quot;=&gt;nil,
      &quot;app_id&quot;=&gt;22979756,
      &quot;domain&quot;=&gt;&quot;floating-retreat-4255.herokuapp.com&quot;,
      &quot;base_domain&quot;=&gt;&quot;herokuapp.com&quot;,
      &quot;created_at&quot;=&gt;nil,
      &quot;default&quot;=&gt;true,
      &quot;updated_at&quot;=&gt;nil},
    &quot;web_url&quot;=&gt;&quot;http://floating-retreat-4255.herokuapp.com/&quot;,
    &quot;git_url&quot;=&gt;&quot;git@heroku.com:floating-retreat-4255.git&quot;,
    &quot;buildpack_provided_description&quot;=&gt;nil,
    &quot;region&quot;=&gt;&quot;us&quot;,
    &quot;created_at&quot;=&gt;&quot;2014/03/12 16:44:09 -0700&quot;,
    &quot;archived_at&quot;=&gt;nil,
    &quot;released_at&quot;=&gt;&quot;2014/03/12 16:44:10 -0700&quot;,
    &quot;updated_at&quot;=&gt;&quot;2014/03/12 16:44:10 -0700&quot;}
</code></pre>

<p>We can read the same information back with the <code>info</code> method.</p>

<pre class="code ruby"><code class="ruby">heroku.app.info(&#39;floating-retreat-4255&#39;)
=&gt; {&quot;id&quot;=&gt;22979756,
    &quot;name&quot;=&gt;&quot;floating-retreat-4255&quot;,
    &quot;dynos&quot;=&gt;0,
    &quot;workers&quot;=&gt;0,
    &quot;repo_size&quot;=&gt;nil,
    &quot;slug_size&quot;=&gt;nil,
    &quot;stack&quot;=&gt;&quot;cedar&quot;,
    &quot;requested_stack&quot;=&gt;nil,
    &quot;create_status&quot;=&gt;&quot;complete&quot;,
    &quot;repo_migrate_status&quot;=&gt;&quot;complete&quot;,
    &quot;owner_delinquent&quot;=&gt;false,
    &quot;owner_email&quot;=&gt;&quot;jkakar@heroku.com&quot;,
    &quot;owner_name&quot;=&gt;nil,
    &quot;domain_name&quot;=&gt;
     {&quot;id&quot;=&gt;nil,
      &quot;app_id&quot;=&gt;22979756,
      &quot;domain&quot;=&gt;&quot;floating-retreat-4255.herokuapp.com&quot;,
      &quot;base_domain&quot;=&gt;&quot;herokuapp.com&quot;,
      &quot;created_at&quot;=&gt;nil,
      &quot;default&quot;=&gt;true,
      &quot;updated_at&quot;=&gt;nil},
    &quot;web_url&quot;=&gt;&quot;http://floating-retreat-4255.herokuapp.com/&quot;,
    &quot;git_url&quot;=&gt;&quot;git@heroku.com:floating-retreat-4255.git&quot;,
    &quot;buildpack_provided_description&quot;=&gt;nil,
    &quot;region&quot;=&gt;&quot;us&quot;,
    &quot;created_at&quot;=&gt;&quot;2014/03/12 16:44:09 -0700&quot;,
    &quot;archived_at&quot;=&gt;nil,
    &quot;released_at&quot;=&gt;&quot;2014/03/12 16:44:12 -0700&quot;,
    &quot;updated_at&quot;=&gt;&quot;2014/03/12 16:44:12 -0700&quot;}
</code></pre>

<p>Let&#39;s add a Heroku PostgreSQL database to our app now:</p>

<pre class="code ruby"><code class="ruby">heroku.addon.create(&#39;floating-retreat-4255&#39;, {&#39;plan&#39; =&gt; &#39;heroku-postgresql:dev&#39;})
=&gt; {&quot;config_vars&quot;=&gt;[&quot;HEROKU_POSTGRESQL_COBALT_URL&quot;],
    &quot;created_at&quot;=&gt;&quot;2014-03-13T00:28:55Z&quot;,
    &quot;id&quot;=&gt;&quot;79a0c826-06be-4dcd-8bb5-f2c1b1bc2beb&quot;,
    &quot;name&quot;=&gt;&quot;heroku-postgresql-cobalt&quot;,
    &quot;plan&quot;=&gt;
     {&quot;id&quot;=&gt;&quot;95a1ce4c-c651-45dc-aaee-79b4603e76b7&quot;,
      &quot;name&quot;=&gt;&quot;heroku-postgresql:dev&quot;},
    &quot;provider_id&quot;=&gt;&quot;resource5924903@heroku.com&quot;,
    &quot;updated_at&quot;=&gt;&quot;2014-03-13T00:28:55Z&quot;}
</code></pre>

<p>Excellent! That will have added a config var which we can now see:</p>

<pre class="code ruby"><code class="ruby">heroku.config_var.info_for_app(&#39;floating-retreat-4255&#39;)
=&gt; {&quot;HEROKU_POSTGRESQL_COBALT_URL&quot;=&gt;&quot;postgres://&lt;redacted&gt;&quot;}
</code></pre>

<p>And there we go, we have the config var. Let&#39;s set an additional config
var, which will also demonstrate how to make a request that needs a
payload:</p>

<pre class="code ruby"><code class="ruby">heroku.config_var.update(&#39;floating-retreat-4255&#39;, {&#39;MYAPP&#39; =&gt; &#39;ROCKS&#39;})
=&gt; {&quot;HEROKU_POSTGRESQL_COBALT_URL&quot;=&gt;&quot;postgres://&lt;redacted&gt;&quot;,
    &quot;MYAPP&quot;=&gt;&quot;ROCKS&quot;}
</code></pre>

<p>As you can see, any action that needs a request body takes it as a plain
Ruby object, as the final parameter of the method call.</p>

<p>Using the same principle you can even pass in a specific version of
PostgreSQL at the time of creation:</p>

<pre class="code ruby"><code class="ruby">heroku.addon.create(&#39;floating-retreat-4255&#39;, {&#39;plan&#39; =&gt; &#39;heroku-postgresql:dev&#39;, &#39;config&#39; =&gt; {&#39;version&#39; =&gt; &#39;9.4&#39;})
</code></pre>

<p>Make sure to use the correct version. If the version is incorrect or
unsupported, it will just error out.</p>

<p>Let&#39;s continue by deploying a sample app. We&#39;ll use the <a
href="https://github.com/heroku-examples/geosockets">Geosockets</a> example
app:</p>

<pre class="code ruby"><code class="ruby">$ git clone https://github.com/heroku-examples/geosockets.git
Cloning into &#39;geosockets&#39;...
remote: Reusing existing pack: 489, done.
remote: Total 489 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (489/489), 1.95 MiB | 1.14 MiB/s, done.
Resolving deltas: 100% (244/244), done.
Checking connectivity... done.
$ cd geosockets
$ git remote add heroku git@heroku.com:floating-retreat-4255.git
$ heroku labs:enable websockets
$ heroku addons:add openredis:micro # $10/month
Adding openredis:micro on floating-retreat-4255... done, v10 ($10/mo)
Use `heroku addons:docs openredis` to view documentation.
$ git push heroku master
Initializing repository, done.
Counting objects: 489, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (229/229), done.
Writing objects: 100% (489/489), 1.95 MiB | 243.00 KiB/s, done.
Total 489 (delta 244), reused 489 (delta 244)
8&lt; snip 8&lt;</code></pre>

<p>We can now use the API to see our <code>web</code> process running:</p>

<pre class="code ruby"><code class="ruby">heroku.formation.list(&#39;floating-retreat-4255&#39;)
=&gt; [{&quot;command&quot;=&gt;&quot;coffee index.coffee&quot;,
     &quot;created_at&quot;=&gt;&quot;2014-03-13T04:13:37Z&quot;,
     &quot;id&quot;=&gt;&quot;f682b260-8089-4e18-b792-688cc02bf923&quot;,
     &quot;type&quot;=&gt;&quot;web&quot;,
     &quot;quantity&quot;=&gt;1,
     &quot;size&quot;=&gt;&quot;1X&quot;,
     &quot;updated_at&quot;=&gt;&quot;2014-03-13T04:13:37Z&quot;}]
</code></pre>

<p>Let&#39;s change <code>web</code> process to run on a 2X dyno:</p>

<pre class="code ruby"><code class="ruby">heroku.formation.batch_update(&#39;floating-retreat-4255&#39;,
                              {&quot;updates&quot; =&gt; [{&quot;process&quot; =&gt; &quot;web&quot;,
                                              &quot;quantity&quot; =&gt; 1,
                                              &quot;size&quot; =&gt; &quot;2X&quot;}]})
=&gt; [{&quot;command&quot;=&gt;&quot;coffee index.coffee&quot;,
     &quot;created_at&quot;=&gt;&quot;2014-03-13T04:13:37Z&quot;,
     &quot;id&quot;=&gt;&quot;f682b260-8089-4e18-b792-688cc02bf923&quot;,
     &quot;type&quot;=&gt;&quot;web&quot;,
     &quot;quantity&quot;=&gt;1,
     &quot;size&quot;=&gt;&quot;2X&quot;,
     &quot;updated_at&quot;=&gt;&quot;2014-03-13T04:22:15Z&quot;}]
</code></pre>

<p>We could have included a number of different kinds of processes in the last
command. We can use the singular update action to modify a single formation
type:</p>

<pre class="code ruby"><code class="ruby">heroku.formation.update(&#39;floating-retreat-4255&#39;, &#39;web&#39;, {&quot;size&quot; =&gt; &quot;1X&quot;})
=&gt; {&quot;command&quot;=&gt;&quot;coffee index.coffee&quot;,
    &quot;created_at&quot;=&gt;&quot;2014-03-13T04:13:37Z&quot;,
    &quot;id&quot;=&gt;&quot;f682b260-8089-4e18-b792-688cc02bf923&quot;,
    &quot;type&quot;=&gt;&quot;web&quot;,
    &quot;quantity&quot;=&gt;1,
    &quot;size&quot;=&gt;&quot;1X&quot;,
    &quot;updated_at&quot;=&gt;&quot;2014-03-13T04:24:46Z&quot;}
</code></pre>

<p>Hopefully this has given you a taste of how the client works. If you have
questions please feel free to file issues.</p>

<h3 id="label-Debugging">Debugging</h3>

<p>Sometimes it helps to see more information about the requests flying by.
You can start your program or an <code>irb</code> session with the
<code>EXCON_DEBUG=1</code> environment variable to cause request and
response data to be written to <code>STDERR</code>.</p>

<h3 id="label-Passing+custom+headers">Passing custom headers</h3>

<p>The various <code>connect</code> methods take an options hash that you can
use to include custom headers to include with every request:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'>PlatformAPI</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my-api-key</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>default_headers:</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Foo</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Bar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Using+a+custom+cache">Using a custom cache</h3>

<p>By default, the <code>platform-api</code> will cache data in
<code>~/.heroics/platform-api</code>. Use a different caching by passing in
the <a href="https://github.com/minad/moneta">Moneta</a> instance you want
to use:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'>PlatformAPI</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my-api-key</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>cache:</span> <span class='const'>Moneta</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:Memory</span><span class='rparen'>)</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Connecting+to+a+different+host">Connecting to a different host</h3>

<p>Connect to a different host by passing a <code>url</code> option:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'>PlatformAPI</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my-api-key</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>url:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://api.example.com</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<h2 id="label-Building+and+releasing">Building and releasing</h2>

<h3 id="label-Generate+a+new+client">Generate a new client</h3>

<p>Generate a new client from the Heroku Platform API JSON schema:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_build'>build</span>
</code></pre>

<p>Remember to commit and push the changes to Github.</p>

<h3 id="label-Release+a+new+gem">Release a new gem</h3>
<ul><li>
<p>This project follows <a href="http://semver.org">semver</a> from version
1.0.0. Please  be sure to keep this in mind if you&#39;re the project
maintainer.</p>
</li><li>
<p>Be sure to run the very basic acceptance rspecs. The rspecs will attempt 
to parse your oauth token for <code>api.heroku.com</code> from your
<code>.netrc</code>. You can  optionally use the <code>OAUTH_TOKEN</code>
and <code>ACCOUNT_EMAIL</code> environment variables.  They don&#39;t
mutate anything but they might in the future.</p>
</li><li>
<p>Bump the version in <code>lib/platform-api/version.rb</code></p>
</li><li>
<p><code>bundle install</code> to update Gemfile.lock</p>
</li><li>
<p>`git commit -m &#39;vX.Y.Z&#39; to stage the version and Gemfile.lock
changes</p>
</li><li>
<p><code>rake release</code> to push git changes and to release to Rubygems</p>
</li></ul>

<h3 id="label-Building+API+documentation">Building API documentation</h3>

<p>Build documentation with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_yard'>yard</span>
</code></pre>

<p>And then visit <code>doc/index.html</code> to read it. Alternately, build
and publish it to Github Pages in one step with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_publish'>publish</span>
</code></pre>

<p>You can see it live on <a
href="http://heroku.github.io/platform-api/">Github Pages</a>.</p>

<h2 id="label-Contributing">Contributing</h2>
<ol><li>
<p><a href="https://github.com/heroku/platform-api/fork">Fork the
repository</a>.</p>
</li><li>
<p>Create your feature branch: <code>git checkout -b my-new-feature</code></p>
</li><li>
<p>Commit your changes: <code>git commit -am &#39;Add some feature&#39;</code></p>
</li><li>
<p>Push to the branch: <code>git push origin my-new-feature</code></p>
</li><li>
<p>Create new pull request.</p>
</li></ol>
</div></div>

    <div id="footer">
  Generated on Tue Sep 26 09:29:21 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.3.0).
</div>

  </body>
</html>